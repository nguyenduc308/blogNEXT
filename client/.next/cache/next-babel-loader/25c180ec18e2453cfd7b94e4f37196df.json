{"ast":null,"code":"var _jsxFileName = \"/Users/duclux/Desktop/NEXT SEO/client/components/crud/BlogUpdate.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect } from 'react';\nimport dynamic from 'next/dynamic';\nimport { withRouter } from 'next/router';\nimport { getCookie } from '../../actions/auth';\nimport { getCategories } from '../../actions/category';\nimport { getTags } from '../../actions/tag';\nimport { getBlog } from '../../actions/blog';\nimport '../../node_modules/react-quill/dist/quill.snow.css';\nimport { quillformats, quillmodules } from '../../helpers/reactQuill';\nconst ReactQuill = dynamic(() => import('react-quill'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('react-quill')],\n    modules: ['react-quill']\n  }\n});\n\nconst BlogUpdate = ({\n  router\n}) => {\n  const {\n    0: blog,\n    1: setBlog\n  } = useState({});\n  const {\n    0: categories,\n    1: setCategories\n  } = useState([]);\n  const {\n    0: tags,\n    1: setTags\n  } = useState([]);\n  const {\n    0: checked,\n    1: setChecked\n  } = useState([]);\n  const {\n    0: checkedTag,\n    1: setCheckedTag\n  } = useState([]);\n  const {\n    0: values,\n    1: setValues\n  } = useState({\n    error: '',\n    sizeError: '',\n    success: '',\n    formData: '',\n    title: ''\n  });\n  const {\n    0: body,\n    1: setBody\n  } = useState('');\n  const {\n    error,\n    success,\n    formData,\n    title\n  } = values;\n\n  const loadBlog = () => {\n    getBlog(router.query.slug).then(data => {\n      if (data && data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setBlog(data);\n        setValues(_objectSpread({}, values, {\n          error: ''\n        }));\n      }\n    });\n  };\n\n  const token = getCookie('token');\n\n  const initCategories = () => {\n    getCategories().then(data => setCategories(data)).catch(err => setValues(_objectSpread({}, values, {\n      error: err\n    })));\n  };\n\n  const initTags = () => {\n    getTags().then(data => setTags(data)).catch(err => setValues(_objectSpread({}, values, {\n      error: err\n    })));\n  };\n\n  const getBlogLocalStorage = () => {\n    if (false) {\n      if (localStorage && localStorage.getItem('blog')) {\n        setBody(JSON.parse(localStorage.getItem('blog')));\n      } else {\n        return false;\n      }\n    }\n  };\n\n  useEffect(() => {\n    setValues(_objectSpread({}, values, {\n      formData: new FormData()\n    }));\n    getBlogLocalStorage();\n    initTags();\n    initCategories();\n    loadBlog();\n  }, [router]);\n\n  const handleSubmit = e => {\n    e.preventDefault();\n  };\n\n  const handleChange = name => e => {\n    const value = name === 'photo' ? e.target.files[0] : e.target.value;\n    formData.set(name, value);\n    setValues(_objectSpread({}, values, {\n      [name]: value,\n      formData,\n      error: ''\n    }));\n  };\n\n  const handleBody = e => {\n    setBody(e);\n    formData.set('body', e);\n\n    if (localStorage) {\n      localStorage.setItem('blog', JSON.stringify(e));\n    }\n  };\n\n  const updateBlogForm = () => {\n    return __jsx(\"form\", {\n      onSubmit: handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, __jsx(\"input\", {\n      type: \"text\",\n      name: \"title\",\n      value: title,\n      placeholder: \"Enter title\",\n      className: \"form-control\",\n      onChange: handleChange('title'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }, __jsx(ReactQuill, {\n      modules: quillmodules,\n      formats: quillformats,\n      value: body,\n      placeholder: \"Type songthing\",\n      onChange: handleBody,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    }, __jsx(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }\n    }, \"Update\")));\n  };\n\n  const handleToggle = c => () => {\n    setValues(_objectSpread({}, values, {\n      error: ''\n    }));\n    const clickedCategory = checked.indexOf(c);\n    let all = [...checked];\n\n    if (clickedCategory === -1) {\n      all.push(c);\n    } else {\n      all.splice(clickedCategory, 1);\n    }\n\n    setChecked(all);\n    formData.set('categories', all);\n  };\n\n  const handleTagToggle = t => () => {\n    setValues(_objectSpread({}, values, {\n      error: ''\n    }));\n    const clickedTag = checkedTag.indexOf(t);\n    let all = [...checkedTag];\n\n    if (clickedTag === -1) {\n      all.push(t);\n    } else {\n      all.splice(clickedTag, 1);\n    }\n\n    setCheckedTag(all);\n    formData.set('tags', all);\n  };\n\n  const showCategories = () => {\n    return categories && categories.map((c, i) => {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 24\n        }\n      }, __jsx(\"input\", {\n        onChange: handleToggle(c._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }\n      }, c.name));\n    });\n  };\n\n  const showTags = () => {\n    return tags && tags.map((t, i) => {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 24\n        }\n      }, __jsx(\"input\", {\n        onChange: handleTagToggle(t._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }\n      }, t.name));\n    });\n  };\n\n  const showError = () => {\n    return __jsx(\"div\", {\n      className: \"alert alert-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 13\n      }\n    }, error);\n  };\n\n  const showSuccess = () => {\n    return __jsx(\"div\", {\n      className: \"alert alert-success\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 13\n      }\n    }, success);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"col-md-8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }, updateBlogForm(), error && showError(), success && showSuccess()), __jsx(\"div\", {\n    className: \"col-md-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"form-group pb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 25\n    }\n  }, \"Featured image\"), __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 25\n    }\n  }), __jsx(\"label\", {\n    htmlFor: \"photo\",\n    className: \"btn btn-outline-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }, \"Upload image\"), __jsx(\"input\", {\n    type: \"file\",\n    accept: \"images/*\",\n    id: \"photo\",\n    name: \"photo\",\n    onChange: handleChange('photo'),\n    hidden: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"categories-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 25\n    }\n  }, \"Categories\"), __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: '400px',\n      overflowY: 'scroll'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 25\n    }\n  }, showCategories())), __jsx(\"div\", {\n    className: \"tag-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 25\n    }\n  }, \"Tags\"), __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: '400px',\n      overflowY: 'scroll'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 25\n    }\n  }, showTags())))));\n};\n\nexport default withRouter(BlogUpdate);","map":{"version":3,"sources":["/Users/duclux/Desktop/NEXT SEO/client/components/crud/BlogUpdate.js"],"names":["useState","useEffect","dynamic","withRouter","getCookie","getCategories","getTags","getBlog","quillformats","quillmodules","ReactQuill","ssr","BlogUpdate","router","blog","setBlog","categories","setCategories","tags","setTags","checked","setChecked","checkedTag","setCheckedTag","values","setValues","error","sizeError","success","formData","title","body","setBody","loadBlog","query","slug","then","data","token","initCategories","catch","err","initTags","getBlogLocalStorage","localStorage","getItem","JSON","parse","FormData","handleSubmit","e","preventDefault","handleChange","name","value","target","files","set","handleBody","setItem","stringify","updateBlogForm","handleToggle","c","clickedCategory","indexOf","all","push","splice","handleTagToggle","t","clickedTag","showCategories","map","i","_id","showTags","showError","showSuccess","maxHeight","overflowY"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport dynamic from 'next/dynamic'\nimport { withRouter } from 'next/router'\nimport { getCookie} from '../../actions/auth'\nimport { getCategories } from '../../actions/category'\nimport { getTags } from '../../actions/tag'\nimport { getBlog } from '../../actions/blog'\nimport '../../node_modules/react-quill/dist/quill.snow.css'\nimport { quillformats, quillmodules } from '../../helpers/reactQuill'\nconst ReactQuill = dynamic(()=> import('react-quill'), {ssr: false});\n\nconst BlogUpdate = ({router}) => {\n    const [blog, setBlog] = useState({})\n    const [categories, setCategories] = useState([])\n    const [tags, setTags] = useState([])\n    const [checked, setChecked] = useState([])\n    const [checkedTag, setCheckedTag] = useState([])\n    const [values, setValues] = useState({\n        error: '',\n        sizeError: '',\n        success: '',\n        formData: '',\n        title: '',\n    })\n    const [body, setBody] = useState('')\n    const { error, success, formData, title} = values;\n    const loadBlog = () => {\n        getBlog(router.query.slug)\n            .then(data => {\n                if(data && data.error) {\n                    setValues({\n                        ...values,\n                        error: data.error\n                    })\n                } else {\n                    setBlog(data)\n                    setValues({\n                        ...values, \n                        error: '',\n                    })\n                }\n            })\n    }\n    const token = getCookie('token')\n    const initCategories = () => {\n        getCategories()\n            .then(data => setCategories(data))\n            .catch(err => setValues({...values, error: err}))\n    }\n    const initTags = () => {\n        getTags()\n            .then(data => setTags(data))\n            .catch(err => setValues({...values, error: err}))\n    }\n    const getBlogLocalStorage = () => {\n        if(typeof window !== 'undefined') {\n            if(localStorage && localStorage.getItem('blog')) {\n                setBody(JSON.parse(localStorage.getItem('blog')))\n            } else {\n                return false;\n            }\n        }\n    }\n    useEffect(() => {\n        setValues({\n            ...values,\n            formData: new FormData(),\n        })\n        getBlogLocalStorage()\n        initTags()\n        initCategories()\n        loadBlog()\n    }, [router])\n    const handleSubmit = e => {                \n        e.preventDefault()\n    }\n    const handleChange = name => e => {\n        const value = name === 'photo' ? e.target.files[0] : e.target.value\n        formData.set(name, value)\n        setValues({\n            ...values,\n            [name]: value,\n            formData,\n            error:''\n        })\n    }\n    const handleBody =  e => {\n        setBody(e)\n        formData.set('body', e);\n        if(localStorage) {\n            localStorage.setItem('blog', JSON.stringify(e))\n        }\n    }\n    const updateBlogForm = () => {\n        return(\n            <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <input \n                    type=\"text\" \n                    name=\"title\"\n                    value={title}\n                    placeholder=\"Enter title\"\n                    className=\"form-control\"\n                    onChange={handleChange('title')}\n                    />\n                </div>\n                <div className=\"form-group\">\n                    <ReactQuill\n                    modules={quillmodules}\n                    formats={quillformats}\n                    value={body}\n                    placeholder=\"Type songthing\"\n                    onChange={handleBody}\n                    />\n                </div>\n                <div className=\"form-group\">\n                    <button type=\"submit\" className=\"btn btn-primary\">\n                        Update\n                    </button>\n                </div>\n            </form>\n        )\n    }\n    const handleToggle = c => () => {\n        setValues({\n            ...values,\n            error: ''\n        })\n        const clickedCategory = checked.indexOf(c);\n        let all = [...checked]\n        if(clickedCategory === -1) {\n            all.push(c)\n        } else {\n            all.splice(clickedCategory, 1)\n        }\n        setChecked(all)\n        formData.set('categories', all)\n    }\n    const handleTagToggle = t => () => {\n        setValues({\n            ...values,\n            error: ''\n        })\n        const clickedTag = checkedTag.indexOf(t);\n        let all = [...checkedTag]\n        if(clickedTag === -1) {\n            all.push(t)\n        } else {\n            all.splice(clickedTag, 1)\n        }\n        setCheckedTag(all)\n        formData.set('tags', all)\n    }\n    const showCategories = () => {\n        return (\n            categories && categories.map((c,i) => {\n                return <li key={i} className=\"list-unstyled\">\n                    <input onChange={handleToggle(c._id)} type=\"checkbox\" className=\"mr-2\"/>\n                    <label htmlFor=\"\" className=\"form-check-label\">\n                        {c.name}\n                    </label>\n                </li>\n            })\n        )\n    }\n    const showTags = () => {\n        return (\n            tags && tags.map((t,i) => {\n                return <li key={i} className=\"list-unstyled\">\n                    <input onChange={handleTagToggle(t._id)} type=\"checkbox\" className=\"mr-2\"/>\n                    <label htmlFor=\"\" className=\"form-check-label\">\n                        {t.name}\n                    </label>\n                </li>\n            })\n        )\n    }\n    const showError = () => {\n        return(\n            <div className=\"alert alert-danger\">\n                {error}\n            </div>\n        )\n    }\n    const showSuccess = () => {\n        return(\n            <div className=\"alert alert-success\">\n                {success}\n            </div>\n        )\n    }\n    return(\n        <>\n            <div className=\"row\">\n                <div className=\"col-md-8\">\n                    {updateBlogForm()}\n                    {error && showError()}\n                    {success && showSuccess()}\n                </div>\n                <div className=\"col-md-4\">\n                    <div className=\"form-group pb-2\">\n                        <h5>Featured image</h5>\n                        <hr/>\n                        <label htmlFor=\"photo\" className=\"btn btn-outline-info\">Upload image</label>\n                        <input \n                        type=\"file\" \n                        accept=\"images/*\"\n                        id=\"photo\"\n                        name=\"photo\"\n                        onChange={handleChange('photo')}\n                        hidden\n                        />\n                    </div>\n                    <div className=\"categories-list\">\n                        <h5>Categories</h5>\n                        <hr />\n                        <ul style={{\n                            maxHeight: '400px',\n                            overflowY: 'scroll'\n                        }}>\n                            {showCategories()}\n                        </ul>\n                    </div>\n                    <div className=\"tag-list\">\n                        <h5>Tags</h5>\n                        <hr/>\n                        <ul style={{\n                            maxHeight: '400px',\n                            overflowY: 'scroll'\n                        }}>\n                            {showTags()}\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </>\n    )\n}\nexport default withRouter(BlogUpdate);\n"]},"metadata":{},"sourceType":"module"}