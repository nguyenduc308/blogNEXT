{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\SoftworldVietnam\\\\Desktop\\\\blogNEXT\\\\client\\\\components\\\\crud\\\\BlogCreate.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from 'react';\nimport dynamic from 'next/dynamic';\nimport { withRouter } from 'next/router';\nimport { getCookie } from '../../actions/auth';\nimport { getCategories } from '../../actions/category';\nimport { getTags } from '../../actions/tag';\nimport { create } from '../../actions/blog';\nimport '../../node_modules/react-quill/dist/quill.snow.css';\nimport { quillformats, quillmodules } from '../../helpers/reactQuill';\nvar ReactQuill = dynamic(_c = function _c() {\n  return import('react-quill');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('react-quill')];\n    },\n    modules: ['react-quill']\n  }\n});\n_c2 = ReactQuill;\n\nvar BlogCreate = function BlogCreate(_ref) {\n  _s();\n\n  var router = _ref.router;\n\n  var _useState = useState([]),\n      categories = _useState[0],\n      setCategories = _useState[1];\n\n  var _useState2 = useState([]),\n      tags = _useState2[0],\n      setTags = _useState2[1];\n\n  var _useState3 = useState([]),\n      checked = _useState3[0],\n      setChecked = _useState3[1];\n\n  var _useState4 = useState([]),\n      checkedTag = _useState4[0],\n      setCheckedTag = _useState4[1];\n\n  var _useState5 = useState(''),\n      body = _useState5[0],\n      setBody = _useState5[1];\n\n  var _useState6 = useState({\n    error: '',\n    sizeError: '',\n    success: '',\n    formData: '',\n    title: '',\n    hidePublishButton: false\n  }),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var token = getCookie('token');\n\n  var initCategories = function initCategories() {\n    getCategories().then(function (data) {\n      return setCategories(data);\n    })[\"catch\"](function (err) {\n      return setValues(_objectSpread(_objectSpread({}, values), {}, {\n        error: err\n      }));\n    });\n  };\n\n  var initTags = function initTags() {\n    getTags().then(function (data) {\n      return setTags(data);\n    })[\"catch\"](function (err) {\n      return setValues(_objectSpread(_objectSpread({}, values), {}, {\n        error: err\n      }));\n    });\n  };\n\n  var error = values.error,\n      success = values.success,\n      formData = values.formData,\n      title = values.title;\n\n  var getBlogLocalStorage = function getBlogLocalStorage() {\n    if (true) {\n      if (localStorage && localStorage.getItem('blog')) {\n        setBody(JSON.parse(localStorage.getItem('blog')));\n      } else {\n        return false;\n      }\n    }\n  };\n\n  useEffect(function () {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      formData: new FormData()\n    }));\n    getBlogLocalStorage();\n    initTags();\n    initCategories();\n  }, [router]);\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    console.log(formData);\n    create(formData, token).then(function (data) {\n      if (data.error) {\n        setValues(_objectSpread(_objectSpread({}, values), {}, {\n          error: data.error\n        }));\n      } else {\n        setValues(_objectSpread(_objectSpread({}, values), {}, {\n          error: '',\n          title: \"\",\n          success: \"Publish success\"\n        }));\n        setBody('');\n        setCheckedTag('');\n        setChecked('');\n      }\n    });\n  };\n\n  var handleChange = function handleChange(name) {\n    return function (e) {\n      var _objectSpread2;\n\n      var value = name === 'photo' ? e.target.files[0] : e.target.value;\n      formData.set(name, value);\n      setValues(_objectSpread(_objectSpread({}, values), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, name, value), _defineProperty(_objectSpread2, \"formData\", formData), _defineProperty(_objectSpread2, \"error\", ''), _objectSpread2)));\n    };\n  };\n\n  var handleBody = function handleBody(e) {\n    setBody(e);\n    formData.set('body', e);\n    console.log(formData);\n\n    if (localStorage) {\n      localStorage.setItem('blog', JSON.stringify(e));\n    }\n  };\n\n  var createBlogForm = function createBlogForm() {\n    return __jsx(\"form\", {\n      onSubmit: handleSubmit,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }\n    }, __jsx(\"input\", {\n      type: \"text\",\n      name: \"title\",\n      value: title,\n      placeholder: \"Enter title\",\n      className: \"form-control\",\n      onChange: handleChange('title'),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }\n    }, __jsx(ReactQuill, {\n      modules: quillmodules,\n      formats: quillformats,\n      value: body,\n      placeholder: \"Type songthing\",\n      onChange: handleBody,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }, __jsx(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    }, \"Publish\")));\n  };\n\n  var handleToggle = function handleToggle(c) {\n    return function () {\n      setValues(_objectSpread(_objectSpread({}, values), {}, {\n        error: ''\n      }));\n      var clickedCategory = checked.indexOf(c);\n\n      var all = _toConsumableArray(checked);\n\n      if (clickedCategory === -1) {\n        all.push(c);\n      } else {\n        all.splice(clickedCategory, 1);\n      }\n\n      setChecked(all);\n      formData.set('categories', all);\n    };\n  };\n\n  var handleTagToggle = function handleTagToggle(t) {\n    return function () {\n      setValues(_objectSpread(_objectSpread({}, values), {}, {\n        error: ''\n      }));\n      var clickedTag = checkedTag.indexOf(t);\n\n      var all = _toConsumableArray(checkedTag);\n\n      if (clickedTag === -1) {\n        all.push(t);\n      } else {\n        all.splice(clickedTag, 1);\n      }\n\n      setCheckedTag(all);\n      formData.set('tags', all);\n    };\n  };\n\n  var showCategories = function showCategories() {\n    return categories && categories.map(function (c, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 24\n        }\n      }, __jsx(\"input\", {\n        onChange: handleToggle(c._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 21\n        }\n      }, c.name));\n    });\n  };\n\n  var showTags = function showTags() {\n    return tags && tags.map(function (t, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 24\n        }\n      }, __jsx(\"input\", {\n        onChange: handleTagToggle(t._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 21\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }\n      }, t.name));\n    });\n  };\n\n  var showError = function showError() {\n    return __jsx(\"div\", {\n      className: \"alert alert-danger\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 13\n      }\n    }, error);\n  };\n\n  var showSuccess = function showSuccess() {\n    return __jsx(\"div\", {\n      className: \"alert alert-success\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }\n    }, success);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"col s-12 m-8 l-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 17\n    }\n  }, createBlogForm(), error && showError(), success && showSuccess()), __jsx(\"div\", {\n    className: \"col s-12 m-4 l-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"form-group pb-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 25\n    }\n  }, \"Featured image\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 25\n    }\n  }), __jsx(\"label\", {\n    htmlFor: \"photo\",\n    className: \"btn btn-outline-info\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 25\n    }\n  }, \"Upload image\"), __jsx(\"input\", {\n    type: \"file\",\n    accept: \"images/*\",\n    id: \"photo\",\n    name: \"photo\",\n    onChange: handleChange('photo'),\n    hidden: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"categories-list\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 25\n    }\n  }, \"Categories\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: '400px',\n      overflowY: 'scroll'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 25\n    }\n  }, showCategories())), __jsx(\"div\", {\n    className: \"tag-list\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 25\n    }\n  }, \"Tags\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: '400px',\n      overflowY: 'scroll'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 25\n    }\n  }, showTags())))));\n};\n\n_s(BlogCreate, \"TVpTiZBZNHuuFOdgaENOSlKmZT4=\");\n\n_c3 = BlogCreate;\nexport default _c4 = withRouter(BlogCreate);\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"ReactQuill$dynamic\");\n$RefreshReg$(_c2, \"ReactQuill\");\n$RefreshReg$(_c3, \"BlogCreate\");\n$RefreshReg$(_c4, \"%default%\");","map":{"version":3,"sources":["C:/Users/SoftworldVietnam/Desktop/blogNEXT/client/components/crud/BlogCreate.js"],"names":["useState","useEffect","dynamic","withRouter","getCookie","getCategories","getTags","create","quillformats","quillmodules","ReactQuill","ssr","BlogCreate","router","categories","setCategories","tags","setTags","checked","setChecked","checkedTag","setCheckedTag","body","setBody","error","sizeError","success","formData","title","hidePublishButton","values","setValues","token","initCategories","then","data","err","initTags","getBlogLocalStorage","localStorage","getItem","JSON","parse","FormData","handleSubmit","e","preventDefault","console","log","handleChange","name","value","target","files","set","handleBody","setItem","stringify","createBlogForm","handleToggle","c","clickedCategory","indexOf","all","push","splice","handleTagToggle","t","clickedTag","showCategories","map","i","_id","showTags","showError","showSuccess","maxHeight","overflowY"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\r\nimport dynamic from 'next/dynamic'\r\nimport { withRouter } from 'next/router'\r\nimport { getCookie} from '../../actions/auth'\r\nimport { getCategories } from '../../actions/category'\r\nimport { getTags } from '../../actions/tag'\r\nimport { create } from '../../actions/blog'\r\nimport '../../node_modules/react-quill/dist/quill.snow.css'\r\nimport { quillformats, quillmodules } from '../../helpers/reactQuill'\r\nconst ReactQuill = dynamic(()=> import('react-quill'), {ssr: false});\r\n\r\nconst BlogCreate = ({router}) => {\r\n    const [categories, setCategories] = useState([])\r\n    const [tags, setTags] = useState([])\r\n    const [checked, setChecked] = useState([])\r\n    const [checkedTag, setCheckedTag] = useState([])\r\n    const [body, setBody] = useState('')\r\n    const [values, setValues] = useState({\r\n        error: '',\r\n        sizeError: '',\r\n        success: '',\r\n        formData: '',\r\n        title: '',\r\n        hidePublishButton: false\r\n    })\r\n    const token = getCookie('token')\r\n    const initCategories = () => {\r\n        getCategories()\r\n            .then(data => setCategories(data))\r\n            .catch(err => setValues({...values, error: err}))\r\n    }\r\n    const initTags = () => {\r\n        getTags()\r\n            .then(data => setTags(data))\r\n            .catch(err => setValues({...values, error: err}))\r\n    }\r\n    const { error, success, formData, title} = values;\r\n    const getBlogLocalStorage = () => {\r\n        if(typeof window !== 'undefined') {\r\n            if(localStorage && localStorage.getItem('blog')) {\r\n                setBody(JSON.parse(localStorage.getItem('blog')))\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        setValues({\r\n            ...values,\r\n            formData: new FormData(),\r\n        })\r\n        getBlogLocalStorage()\r\n        initTags()\r\n        initCategories()\r\n    }, [router])\r\n    const handleSubmit = e => {                \r\n        e.preventDefault()\r\n        console.log(formData);\r\n        create(formData, token)\r\n            .then(data => {\r\n                if(data.error) {\r\n                    setValues({\r\n                        ...values,\r\n                        error: data.error\r\n                    })\r\n                } else {\r\n                    setValues({\r\n                        ...values,\r\n                        error:'',\r\n                        title: \"\",\r\n                        success: \"Publish success\"\r\n                    })\r\n                    setBody('')\r\n                    setCheckedTag('')\r\n                    setChecked('')\r\n                }\r\n            })\r\n    }\r\n    const handleChange = name => e => {\r\n        const value = name === 'photo' ? e.target.files[0] : e.target.value\r\n        formData.set(name, value)\r\n        setValues({\r\n            ...values,\r\n            [name]: value,\r\n            formData,\r\n            error:''\r\n        })\r\n    }\r\n    const handleBody =  e => {\r\n        setBody(e)\r\n        formData.set('body', e);\r\n        console.log(formData);\r\n        if(localStorage) {\r\n            localStorage.setItem('blog', JSON.stringify(e))\r\n        }\r\n    }\r\n    const createBlogForm = () => {\r\n        return(\r\n            <form onSubmit={handleSubmit}>\r\n                <div className=\"form-group\">\r\n                    <input \r\n                    type=\"text\" \r\n                    name=\"title\"\r\n                    value={title}\r\n                    placeholder=\"Enter title\"\r\n                    className=\"form-control\"\r\n                    onChange={handleChange('title')}\r\n                    />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <ReactQuill\r\n                    modules={quillmodules}\r\n                    formats={quillformats}\r\n                    value={body}\r\n                    placeholder=\"Type songthing\"\r\n                    onChange={handleBody}\r\n                    />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <button type=\"submit\" className=\"btn btn-primary\">\r\n                        Publish\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        )\r\n    }\r\n    const handleToggle = c => () => {\r\n        setValues({\r\n            ...values,\r\n            error: ''\r\n        })\r\n        const clickedCategory = checked.indexOf(c);\r\n        let all = [...checked]\r\n        if(clickedCategory === -1) {\r\n            all.push(c)\r\n        } else {\r\n            all.splice(clickedCategory, 1)\r\n        }\r\n        setChecked(all)\r\n        formData.set('categories', all)\r\n    }\r\n    const handleTagToggle = t => () => {\r\n        setValues({\r\n            ...values,\r\n            error: ''\r\n        })\r\n        const clickedTag = checkedTag.indexOf(t);\r\n        let all = [...checkedTag]\r\n        if(clickedTag === -1) {\r\n            all.push(t)\r\n        } else {\r\n            all.splice(clickedTag, 1)\r\n        }\r\n        setCheckedTag(all)\r\n        formData.set('tags', all)\r\n    }\r\n    const showCategories = () => {\r\n        return (\r\n            categories && categories.map((c,i) => {\r\n                return <li key={i} className=\"list-unstyled\">\r\n                    <input onChange={handleToggle(c._id)} type=\"checkbox\" className=\"mr-2\"/>\r\n                    <label htmlFor=\"\" className=\"form-check-label\">\r\n                        {c.name}\r\n                    </label>\r\n                </li>\r\n            })\r\n        )\r\n    }\r\n    const showTags = () => {\r\n        return (\r\n            tags && tags.map((t,i) => {\r\n                return <li key={i} className=\"list-unstyled\">\r\n                    <input onChange={handleTagToggle(t._id)} type=\"checkbox\" className=\"mr-2\"/>\r\n                    <label htmlFor=\"\" className=\"form-check-label\">\r\n                        {t.name}\r\n                    </label>\r\n                </li>\r\n            })\r\n        )\r\n    }\r\n    const showError = () => {\r\n        return(\r\n            <div className=\"alert alert-danger\">\r\n                {error}\r\n            </div>\r\n        )\r\n    }\r\n    const showSuccess = () => {\r\n        return(\r\n            <div className=\"alert alert-success\">\r\n                {success}\r\n            </div>\r\n        )\r\n    }\r\n    return(\r\n        <>\r\n            <div className=\"row\">\r\n                <div className=\"col s-12 m-8 l-8\">\r\n                    {createBlogForm()}\r\n                    {error && showError()}\r\n                    {success && showSuccess()}\r\n                </div>\r\n                <div className=\"col s-12 m-4 l-4\">\r\n                    <div className=\"form-group pb-2\">\r\n                        <h5>Featured image</h5>\r\n                        <hr/>\r\n                        <label htmlFor=\"photo\" className=\"btn btn-outline-info\">Upload image</label>\r\n                        <input \r\n                        type=\"file\" \r\n                        accept=\"images/*\"\r\n                        id=\"photo\"\r\n                        name=\"photo\"\r\n                        onChange={handleChange('photo')}\r\n                        hidden\r\n                        />\r\n                    </div>\r\n                    <div className=\"categories-list\">\r\n                        <h5>Categories</h5>\r\n                        <hr />\r\n                        <ul style={{\r\n                            maxHeight: '400px',\r\n                            overflowY: 'scroll'\r\n                        }}>\r\n                            {showCategories()}\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"tag-list\">\r\n                        <h5>Tags</h5>\r\n                        <hr/>\r\n                        <ul style={{\r\n                            maxHeight: '400px',\r\n                            overflowY: 'scroll'\r\n                        }}>\r\n                            {showTags()}\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\nexport default withRouter(BlogCreate);\r\n"]},"metadata":{},"sourceType":"module"}