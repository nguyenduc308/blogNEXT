{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/duclux/Desktop/NEXT SEO/client/components/crud/BlogUpdate.js\";\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport { withRouter } from \"next/router\";\nimport { getCookie } from \"../../actions/auth\";\nimport { getCategories } from \"../../actions/category\";\nimport { getTags } from \"../../actions/tag\";\nimport { getBlog } from \"../../actions/blog\";\nimport \"../../node_modules/react-quill/dist/quill.snow.css\";\nimport { quillformats, quillmodules } from \"../../helpers/reactQuill\";\nvar ReactQuill = dynamic(function () {\n  return import(\"react-quill\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-quill\")];\n    },\n    modules: [\"react-quill\"]\n  }\n});\n\nvar BlogUpdate = function BlogUpdate(_ref) {\n  var router = _ref.router;\n\n  var _useState = useState({}),\n      blog = _useState[0],\n      setBlog = _useState[1];\n\n  var _useState2 = useState([]),\n      categories = _useState2[0],\n      setCategories = _useState2[1];\n\n  var _useState3 = useState([]),\n      tags = _useState3[0],\n      setTags = _useState3[1];\n\n  var _useState4 = useState([]),\n      checked = _useState4[0],\n      setChecked = _useState4[1];\n\n  var _useState5 = useState([]),\n      checkedTag = _useState5[0],\n      setCheckedTag = _useState5[1];\n\n  var _useState6 = useState({\n    error: \"\",\n    sizeError: \"\",\n    success: \"\",\n    formData: \"\",\n    title: \"\"\n  }),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      body = _useState7[0],\n      setBody = _useState7[1];\n\n  var error = values.error,\n      success = values.success,\n      formData = values.formData,\n      title = values.title;\n\n  var loadBlog = function loadBlog() {\n    getBlog(router.query.slug).then(function (data) {\n      if (data) {\n        if (data.error) {\n          setValues(_objectSpread({}, values, {\n            error: data.error\n          }));\n        } else {\n          setBlog(data);\n          setValues(_objectSpread({}, values, {\n            error: \"\",\n            title: data.title\n          }));\n          setBody(data.body);\n          data.categories && setCategoriesArr(data.categories);\n          data.tags && setTagsArr(data.tags);\n        }\n      }\n    });\n  };\n\n  var setCategoriesArr = function setCategoriesArr(categories) {\n    var ca = [];\n    categories && categories.map(function (c, i) {\n      captureEvents.push(c._id);\n    });\n    setChecked(c);\n  };\n\n  var setTagsArr = function setTagsArr(tags) {\n    var ta = [];\n    tags && tags.map(function (t, i) {\n      ta.push(t._id);\n    });\n    setChecked(ta);\n  };\n\n  var token = getCookie(\"token\");\n\n  var initCategories = function initCategories() {\n    getCategories().then(function (data) {\n      return setCategories(data);\n    })[\"catch\"](function (err) {\n      return setValues(_objectSpread({}, values, {\n        error: err\n      }));\n    });\n  };\n\n  var initTags = function initTags() {\n    getTags().then(function (data) {\n      return setTags(data);\n    })[\"catch\"](function (err) {\n      return setValues(_objectSpread({}, values, {\n        error: err\n      }));\n    });\n  };\n\n  var getBlogLocalStorage = function getBlogLocalStorage() {\n    if (true) {\n      if (localStorage && localStorage.getItem(\"blog\")) {\n        setBody(JSON.parse(localStorage.getItem(\"blog\")));\n      } else {\n        return false;\n      }\n    }\n  };\n\n  useEffect(function () {\n    setValues(_objectSpread({}, values, {\n      formData: new FormData()\n    }));\n    getBlogLocalStorage();\n    initTags();\n    initCategories();\n    loadBlog();\n  }, [router]);\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n  };\n\n  var handleChange = function handleChange(name) {\n    return function (e) {\n      var _objectSpread2;\n\n      var value = name === \"photo\" ? e.target.files[0] : e.target.value;\n      formData.set(name, value);\n      setValues(_objectSpread({}, values, (_objectSpread2 = {}, _defineProperty(_objectSpread2, name, value), _defineProperty(_objectSpread2, \"formData\", formData), _defineProperty(_objectSpread2, \"error\", \"\"), _objectSpread2)));\n    };\n  };\n\n  var handleBody = function handleBody(e) {\n    setBody(e);\n    formData.set(\"body\", e);\n\n    if (localStorage) {\n      localStorage.setItem(\"blog\", JSON.stringify(e));\n    }\n  };\n\n  var updateBlogForm = function updateBlogForm() {\n    return __jsx(\"form\", {\n      onSubmit: handleSubmit,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    }, __jsx(\"input\", {\n      type: \"text\",\n      name: \"title\",\n      value: title,\n      placeholder: \"Enter title\",\n      className: \"form-control\",\n      onChange: handleChange(\"title\"),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }\n    }, __jsx(ReactQuill, {\n      modules: quillmodules,\n      formats: quillformats,\n      value: body,\n      placeholder: \"Type songthing\",\n      onChange: handleBody,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }\n    }, __jsx(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 21\n      }\n    }, \"Update\")));\n  };\n\n  var handleToggle = function handleToggle(c) {\n    return function () {\n      var clickedCategory = checked.indexOf(c);\n\n      var all = _toConsumableArray(checked);\n\n      if (clickedCategory === -1) {\n        all.push(c);\n      } else {\n        all.splice(clickedCategory, 1);\n      }\n\n      setChecked(all);\n      formData.set(\"categories\", all);\n    };\n  };\n\n  var handleTagToggle = function handleTagToggle(t) {\n    return function () {\n      setValues(_objectSpread({}, values, {\n        error: \"\"\n      }));\n      var clickedTag = checkedTag.indexOf(t);\n\n      var all = _toConsumableArray(checkedTag);\n\n      if (clickedTag === -1) {\n        all.push(t);\n      } else {\n        all.splice(clickedTag, 1);\n      }\n\n      setCheckedTag(all);\n      formData.set(\"tags\", all);\n    };\n  };\n\n  var checkedCategoryOut = function checkedCategoryOut(id) {\n    var re = checked.indexOf(id);\n\n    if (re !== -1) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var checkedTagOut = function checkedTagOut(id) {\n    var re = checkedTag.indexOf(id);\n\n    if (re !== -1) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var showCategories = function showCategories() {\n    return categories && categories.map(function (c, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 21\n        }\n      }, __jsx(\"input\", {\n        checked: function checked() {\n          return checkedCategoryOut(c._id);\n        },\n        onChange: handleToggle(c._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 25\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 25\n        }\n      }, c.name));\n    });\n  };\n\n  var showTags = function showTags() {\n    return tags && tags.map(function (t, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 21\n        }\n      }, __jsx(\"input\", {\n        checked: function checked() {\n          return checkedTagOut(t._id);\n        },\n        onChange: handleTagToggle(t._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 25\n        }\n      }), __jsx(\"label\", {\n        htmlFor: \"\",\n        className: \"form-check-label\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }\n      }, t.name));\n    });\n  };\n\n  var showError = function showError() {\n    return __jsx(\"div\", {\n      className: \"alert alert-danger\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 16\n      }\n    }, error);\n  };\n\n  var showSuccess = function showSuccess() {\n    return __jsx(\"div\", {\n      className: \"alert alert-success\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 16\n      }\n    }, success);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"col-md-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 17\n    }\n  }, updateBlogForm(), error && showError(), success && showSuccess()), __jsx(\"div\", {\n    className: \"col-md-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"form-group pb-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 25\n    }\n  }, \"Featured image\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 25\n    }\n  }), __jsx(\"label\", {\n    htmlFor: \"photo\",\n    className: \"btn btn-outline-info\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 25\n    }\n  }, \"Upload image\"), __jsx(\"input\", {\n    type: \"file\",\n    accept: \"images/*\",\n    id: \"photo\",\n    name: \"photo\",\n    onChange: handleChange(\"photo\"),\n    hidden: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"categories-list\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 25\n    }\n  }, \"Categories\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: \"400px\",\n      overflowY: \"scroll\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 25\n    }\n  }, showCategories())), __jsx(\"div\", {\n    className: \"tag-list\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 21\n    }\n  }, __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 25\n    }\n  }, \"Tags\"), __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 25\n    }\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: \"400px\",\n      overflowY: \"scroll\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 25\n    }\n  }, showTags())))));\n};\n\nexport default withRouter(BlogUpdate);","map":{"version":3,"sources":["/Users/duclux/Desktop/NEXT SEO/client/components/crud/BlogUpdate.js"],"names":["useState","useEffect","dynamic","withRouter","getCookie","getCategories","getTags","getBlog","quillformats","quillmodules","ReactQuill","ssr","BlogUpdate","router","blog","setBlog","categories","setCategories","tags","setTags","checked","setChecked","checkedTag","setCheckedTag","error","sizeError","success","formData","title","values","setValues","body","setBody","loadBlog","query","slug","then","data","setCategoriesArr","setTagsArr","ca","map","c","i","captureEvents","push","_id","ta","t","token","initCategories","err","initTags","getBlogLocalStorage","localStorage","getItem","JSON","parse","FormData","handleSubmit","e","preventDefault","handleChange","name","value","target","files","set","handleBody","setItem","stringify","updateBlogForm","handleToggle","clickedCategory","indexOf","all","splice","handleTagToggle","clickedTag","checkedCategoryOut","id","re","checkedTagOut","showCategories","showTags","showError","showSuccess","maxHeight","overflowY"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport { withRouter } from \"next/router\";\nimport { getCookie } from \"../../actions/auth\";\nimport { getCategories } from \"../../actions/category\";\nimport { getTags } from \"../../actions/tag\";\nimport { getBlog } from \"../../actions/blog\";\nimport \"../../node_modules/react-quill/dist/quill.snow.css\";\nimport { quillformats, quillmodules } from \"../../helpers/reactQuill\";\nconst ReactQuill = dynamic(() => import(\"react-quill\"), { ssr: false });\n\nconst BlogUpdate = ({ router }) => {\n    const [blog, setBlog] = useState({});\n    const [categories, setCategories] = useState([]);\n    const [tags, setTags] = useState([]);\n    const [checked, setChecked] = useState([]);\n    const [checkedTag, setCheckedTag] = useState([]);\n    const [values, setValues] = useState({\n        error: \"\",\n        sizeError: \"\",\n        success: \"\",\n        formData: \"\",\n        title: \"\",\n    });\n    const [body, setBody] = useState(\"\");\n    const { error, success, formData, title } = values;\n    const loadBlog = () => {\n        getBlog(router.query.slug).then((data) => {\n            if (data) {\n                if (data.error) {\n                    setValues({\n                        ...values,\n                        error: data.error,\n                    });\n                } else {\n                    setBlog(data);\n                    setValues({\n                        ...values,\n                        error: \"\",\n                        title: data.title,\n                    });\n                    setBody(data.body);\n                    data.categories && setCategoriesArr(data.categories)\n                    data.tags && setTagsArr(data.tags)\n                }\n            }\n        });\n    };\n    const setCategoriesArr = (categories) => {\n        let ca = [];\n        categories && categories.map((c,i)=> {\n            captureEvents.push(c._id)\n        })\n        setChecked(c)\n    }\n    const setTagsArr = (tags) => {\n        let ta = [];\n        tags && tags.map((t,i)=> {\n            ta.push(t._id)\n        })\n        setChecked(ta)\n    }\n    const token = getCookie(\"token\");\n    const initCategories = () => {\n        getCategories()\n            .then((data) => setCategories(data))\n            .catch((err) => setValues({ ...values, error: err }));\n    };\n    const initTags = () => {\n        getTags()\n            .then((data) => setTags(data))\n            .catch((err) => setValues({ ...values, error: err }));\n    };\n    const getBlogLocalStorage = () => {\n        if (typeof window !== \"undefined\") {\n            if (localStorage && localStorage.getItem(\"blog\")) {\n                setBody(JSON.parse(localStorage.getItem(\"blog\")));\n            } else {\n                return false;\n            }\n        }\n    };\n    useEffect(() => {\n        setValues({\n            ...values,\n            formData: new FormData(),\n        });\n        getBlogLocalStorage();\n        initTags();\n        initCategories();\n        loadBlog();\n    }, [router]);\n    const handleSubmit = (e) => {\n        e.preventDefault();\n    };\n    const handleChange = (name) => (e) => {\n        const value = name === \"photo\" ? e.target.files[0] : e.target.value;\n        formData.set(name, value);\n        setValues({\n            ...values,\n            [name]: value,\n            formData,\n            error: \"\",\n        });\n    };\n    const handleBody = (e) => {\n        setBody(e);\n        formData.set(\"body\", e);\n        if (localStorage) {\n            localStorage.setItem(\"blog\", JSON.stringify(e));\n        }\n    };\n    const updateBlogForm = () => {\n        return (\n            <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <input\n                        type=\"text\"\n                        name=\"title\"\n                        value={title}\n                        placeholder=\"Enter title\"\n                        className=\"form-control\"\n                        onChange={handleChange(\"title\")}\n                    />\n                </div>\n                <div className=\"form-group\">\n                    <ReactQuill\n                        modules={quillmodules}\n                        formats={quillformats}\n                        value={body}\n                        placeholder=\"Type songthing\"\n                        onChange={handleBody}\n                    />\n                </div>\n                <div className=\"form-group\">\n                    <button type=\"submit\" className=\"btn btn-primary\">\n                        Update\n                    </button>\n                </div>\n            </form>\n        );\n    };\n    const handleToggle = (c) => () => {\n        const clickedCategory = checked.indexOf(c);\n        let all = [...checked];\n        if (clickedCategory === -1) {\n            all.push(c);\n        } else {\n            all.splice(clickedCategory, 1);\n        }\n        setChecked(all);\n        formData.set(\"categories\", all);\n    };\n    const handleTagToggle = (t) => () => {\n        setValues({\n            ...values,\n            error: \"\",\n        });\n        const clickedTag = checkedTag.indexOf(t);\n        let all = [...checkedTag];\n        if (clickedTag === -1) {\n            all.push(t);\n        } else {\n            all.splice(clickedTag, 1);\n        }\n        setCheckedTag(all);\n        formData.set(\"tags\", all);\n    };\n    const checkedCategoryOut = (id) => {\n        const re = checked.indexOf(id)\n        if(re !==  -1) {\n            return true\n        } else {\n            return false\n        }\n    }\n    const checkedTagOut = (id) => {\n        const re = checkedTag.indexOf(id)\n        if(re !==  -1) {\n            return true\n        } else {\n            return false\n        }\n    }\n    const showCategories = () => {\n        return (\n            categories &&\n            categories.map((c, i) => {\n                return (\n                    <li key={i} className=\"list-unstyled\">\n                        <input\n                            checked={()=>checkedCategoryOut(c._id)}\n                            onChange={handleToggle(c._id)}\n                            type=\"checkbox\"\n                            className=\"mr-2\"\n                        />\n                        <label htmlFor=\"\" className=\"form-check-label\">\n                            {c.name}\n                        </label>\n                    </li>\n                );\n            })\n        );\n    };\n    const showTags = () => {\n        return (\n            tags &&\n            tags.map((t, i) => {\n                return (\n                    <li key={i} className=\"list-unstyled\">\n                        <input\n                            checked={()=>checkedTagOut(t._id)}\n                            onChange={handleTagToggle(t._id)}\n                            type=\"checkbox\"\n                            className=\"mr-2\"\n                        />\n                        <label htmlFor=\"\" className=\"form-check-label\">\n                            {t.name}\n                        </label>\n                    </li>\n                );\n            })\n        );\n    };\n    const showError = () => {\n        return <div className=\"alert alert-danger\">{error}</div>;\n    };\n    const showSuccess = () => {\n        return <div className=\"alert alert-success\">{success}</div>;\n    };\n    return (\n        <>\n            <div className=\"row\">\n                <div className=\"col-md-8\">\n                    {updateBlogForm()}\n                    {error && showError()}\n                    {success && showSuccess()}\n                </div>\n                <div className=\"col-md-4\">\n                    <div className=\"form-group pb-2\">\n                        <h5>Featured image</h5>\n                        <hr />\n                        <label htmlFor=\"photo\" className=\"btn btn-outline-info\">\n                            Upload image\n                        </label>\n                        <input\n                            type=\"file\"\n                            accept=\"images/*\"\n                            id=\"photo\"\n                            name=\"photo\"\n                            onChange={handleChange(\"photo\")}\n                            hidden\n                        />\n                    </div>\n                    <div className=\"categories-list\">\n                        <h5>Categories</h5>\n                        <hr />\n                        <ul\n                            style={{\n                                maxHeight: \"400px\",\n                                overflowY: \"scroll\",\n                            }}\n                        >\n                            {showCategories()}\n                        </ul>\n                    </div>\n                    <div className=\"tag-list\">\n                        <h5>Tags</h5>\n                        <hr />\n                        <ul\n                            style={{\n                                maxHeight: \"400px\",\n                                overflowY: \"scroll\",\n                            }}\n                        >\n                            {showTags()}\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </>\n    );\n};\nexport default withRouter(BlogUpdate);\n"]},"metadata":{},"sourceType":"module"}